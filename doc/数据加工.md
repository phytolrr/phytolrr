# 数据加工

从数据库中，读取到序列ID以及对应的LRR位点、N糖位点、二级结构后，按照如下的顺序做处理：

## 拟南芥swiss prot蛋白质谱文件分析

pass

## step1. 根据激酶域进化树tree文件分析每个物种在每个亚家族sequence的数目和百分比

1. 根据进化树tree文件导出亚家族分类，序列ID位于: nsites/phy_trees/valid_tree_190510/iqtree_analisys_gt8/17_species_kinase_valid_signalP_filtered.ali_trimal.fasta.iqtree
2. 子figtree中，按照拟南芥的亚家族分类，手工标记为18个亚家族，tree文件位于：/home/cts/data/nsites/phy_trees/figtree/2999seqs_iqtree.tree
3. 将亚家族tree文件导出18个list，对应每个亚家族的所有seq_id
4. 为17个物种、18个亚家族的seq_id正交，形成矩阵，计算每个单元格的sequence的数目和百分比，形成两张热图

当前第3步通过bash脚本计算，第4步热图通过R脚本，调用heatmap组件生成，均未归档

亚家族id位置nsites/phy_trees/valid_tree_190510/iqtree_analisys_gt8/ids_SG_try2_190514/sg_id_*

## 预测17个物种所有胞外域序列的LRR、N糖位点(nsites)、二级结构(ss)、亲疏水性(acc20)

手工标注、建立数据库

## step2. 统计不同亚家族LRR数目

1. 统计每个亚家族中，所有序列的LRR数目
2. 使用R语言的ggplot2画小提琴图
3. 发现第10家族LRR数目两级分化，手工分成两个亚家族（以20为界)，重画小提琴图

## step3. 计算胞外域的LRR及N糖分布特征

1. 将17个物种与19个亚家族做正交，计算每个单元格的如下数据，并分别画热图
    1. 每100个氨基酸LRR的数目
    2. 每100个氨基酸N糖的数目
2. 计算19个亚家族N糖位点在LRR内和外的数目，画箱图
3. 计算19个亚家族N糖位点在CHE二级结构上的数目，画箱图
4. 计算第7-1、7-2、10、11、12共5个亚家族的N糖在超螺旋上的数目，画箱图
    1. 对于一个LRR，LXXLXLXXN是超螺旋内部
    2. XLSGXIPXXLXXLXX是非内部
5. 第7-1、7-2、10、11、12共5个亚家族与3种二级结构做正交，计算每个单元格的数据
    1. 筛选LRR数量大于20的序列
    2. 获取N糖位点前后各5个氨基酸，画weblogo，每个单元格一个
    3. 获取N糖位点前后各5个氨基酸的acc20，取平均值，画折线图，折线图按照subgroup做汇总，共五张，每张图体现CHE三根折线
    4. 每个家族所有LRR（取24长度，不够舍弃）的acc20在每个位点的平均值，画一张图五条线
    5. 计算N糖个数，共15个，按照亚家族分为5组，画柱状图
6. 与第5步类似，取非N糖位点的N，做3个图(除了LRR那一张)
7. 第7、10、11、12共5个亚家族与LRR内、侧、背三面正交，计算每个单元格数据
    1. LRR inside：LXXLXLXXN(9个)，beside：XLSGXIP(7个)，back：XXLXXLXX(8个)，筛选LRR数量大于20的序列
    2. 获取N糖位点前后各5个氨基酸，画weblogo
    3. 获取N糖位点前后各5个氨基酸的acc20，取平均值，画折线图
    4. 计算N糖个数，共15个，按照亚家族分5组，画柱状图
8. 与7类似，做个非N糖的
9. 每个亚家族的前30%、中间、后30%的LRR与LRR内、侧、背三面正交，计算每个单元格内N糖数量，并为每个亚家族画一张柱状图
    1. LRR要大于20个的序列
10. 获取7个已知晶体结构的序列的同源序列，分析其LRR上每个offset的可变氨基酸的分布规律
    1. 通过blast获取7个已知晶体结构的同源序列
    2. 用MAFFT作序列比对
    3. 分析LRR上每个offset的可变氨基酸的分布规律，生成weblogo
        1. 为LRR的所有X位点，分别计算weblogo
        2. 从组中已知晶体结构的序列，获取每个LRR的相对位点和绝对offset，相对位点的氨基酸生成及本序列的计算序列，绝对offset应用于其他序列，生成对应序列的计算序列，序列比对为空的用X代替
        3. 所有组内序列的计算序列作为输入，生成weblogo
